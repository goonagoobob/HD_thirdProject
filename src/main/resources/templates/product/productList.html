<!-- *********************************
 * @function : 상품 리스트 페이지
 * @author : 조일우
 * @Date : Feb 7. 2023
 * 상품 리스트 레이아웃 완성 Feb 7. 2023
 * 타임리프 레이아웃 추가 카테고리 창 추가 Feb 8. 2023
 * 상품 리스트 출력  Feb 10. 2023
 * 특정 카테고리 상품만 출력 가능 Feb 10. 2023
 * 컬러 변경 구현 Feb 11. 2023
 * 무한 스크롤 구현 Feb 11. 2023
 * 상품 조건별로 동적 출력 구현 Feb 12. 2023
 ********************************* -->
<html lang="ko" class="back" xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<head>
<meta charset="UTF-8" />
<meta name="HandheldFriendly" content="true" />
<meta name="format-detection" content="telephone=no" />
<title>더한섬닷컴</title>
<link rel="shortcut icon"
	href="https://www.thehandsome.com/_ui/mobile/common/images/common/thehandsome_ic_16x16.ico" />
<link rel="apple-touch-icon"
	href="https://www.thehandsome.com/_ui/mobile/common/images/common/app_ban_logo.png" />
<link rel="apple-touch-icon-precomposed"
	href="https://www.thehandsome.com/_ui/mobile/common/images/common/app_ban_logo.png" />
<link rel="apple-touch-icon-120x120"
	href="https://www.thehandsome.com/_ui/mobile/common/images/common/app_ban_logo.png" />
<link rel="apple-touch-icon-120x120-precomposed"
	href="https://www.thehandsome.com/_ui/mobile/common/images/common/app_ban_logo.png" />
<link rel="shortcut icon" type="image/x-icon" media="all" href="//" />

<link
	href="https://www.thehandsome.com/_ui/handsomemobile/css/handsomecss/font_80.css?20221121"
	rel="stylesheet" type="text/css" />
<link
	href="https://www.thehandsome.com/_ui/handsomemobile/css/handsomecss/jquery-ui.css"
	rel="stylesheet" type="text/css" />
<link
	href="https://www.thehandsome.com/_ui/handsomemobile/css/handsomecss/selectordie.css"
	rel="stylesheet" type="text/css" />
<link
	href="https://www.thehandsome.com/_ui/handsomemobile/css/handsomecss/default.css?202200826"
	rel="stylesheet" type="text/css" />
<link
	href="https://www.thehandsome.com/_ui/handsomemobile/css/handsomecss/display.css?20221107"
	rel="stylesheet" type="text/css" />
<link
	href="https://www.thehandsome.com/_ui/handsomemobile/css/handsomecss/assist.css?20220929"
	rel="stylesheet" type="text/css" />
<link
	href="https://www.thehandsome.com/_ui/handsomemobile/css/handsomecss/devAssist.css"
	rel="stylesheet" type="text/css" />

<link
	href="https://www.thehandsome.com/_ui/handsomemobile/css/handsomecss/popup.css"
	rel="stylesheet" type="text/css" />

<script type="text/javascript"
	src="https://www.thehandsome.com/_ui/handsomemobile/js/jquery.min.js"></script>
<script type="text/javascript"
	src="https://www.thehandsome.com/_ui/handsomemobile/js/jquery.vticker.js"></script>
<!-- 200318 Ã¬Â¶ÂÃªÂ°Â -->
<script type="text/javascript"
	src="https://www.thehandsome.com/_ui/handsomemobile/js/masonry.pkgd.min.js"></script>
<script type="text/javascript"
	src="https://www.thehandsome.com/_ui/handsomemobile/js/imagesloaded.pkgd.min.js"></script>
<script type="text/javascript"
	src="https://www.thehandsome.com/_ui/handsomemobile/js/jquery.form.min.js"></script>
<script type="text/javascript"
	src="https://www.thehandsome.com/_ui/handsomemobile/js/jquery.cookie.js"></script>
<script type="text/javascript"
	src="https://www.thehandsome.com/_ui/handsomemobile/js/jquery-ui.min.js"></script>
<script type="text/javascript"
	src="https://www.thehandsome.com/_ui/handsomemobile/js/swiper.min.js"></script>
<script type="text/javascript"
	src="https://www.thehandsome.com/_ui/handsomemobile/js/selectordie.min.js"></script>
<script type="text/javascript"
	src="https://www.thehandsome.com/_ui/handsomemobile/js/jquery.bpopup.min.js"></script>
<script type="text/javascript"
	src="https://www.thehandsome.com/_ui/handsomemobile/js/echarts.min.js"></script>
<script type="text/javascript" src="../../static/product/common.js"></script>
<script type="text/javascript"
	src="https://www.thehandsome.com/_ui/handsomemobile/js/assist_common.js?v=20220630"></script>
<script type="text/javascript"
	src="https://www.thehandsome.com/_ui/handsomemobile/js/handsome.js"></script>
<script type="text/javascript"
	src="https://www.thehandsome.com/_ui/handsomemobile/js/common_function.js"></script>
<script type="text/javascript"
	src="https://www.thehandsome.com/_ui/handsomemobile/js/json2.js"></script>
<script type="text/javascript"
	src="https://www.thehandsome.com/_ui/handsomemobile/js/SsoAjax.js"></script>

<script type="text/javascript"
	src="https://www.thehandsome.com/_ui/handsomemobile/js/instagramAPI.js"></script>
<script type="text/javascript"
	src="https://www.thehandsome.com/_ui/handsomemobile/js/makePCookie.js"></script>
<script type="text/javascript"
	src="https://www.thehandsome.com/_ui/handsomemobile/js/content.js"></script>
<script type="text/javascript"
	src="https://www.thehandsome.com/_ui/handsomemobile/js/e-smart-zoom-jquery.min.js"></script>
<script type="text/javascript"
	src="https://www.thehandsome.com/_ui/handsomemobile/js/popup.js"></script>
<script type="text/javascript"
	src="https://www.thehandsome.com/_ui/handsomemobile/js/simplepagination.js"></script>
<script type="text/javascript"
	src="https://www.thehandsome.com/_ui/handsomemobile/js/netfunnel.js"
	charset="UTF-8"></script>
<script type="text/javascript"
	src="https://www.thehandsome.com/_ui/handsomemobile/js/netfunnel_skin.js"
	charset="UTF-8"></script>

<script type="text/javascript"
	src="https://www.thehandsome.com/_ui/handsomemobile/js/unorm.js"></script>
<script type="text/javascript" async=""
	src="https://googleads.g.doubleclick.net/pagead/viewthroughconversion/943253288/?random=1675383728850&amp;cv=9&amp;fst=1675383728850&amp;num=1&amp;guid=ON&amp;resp=GooglemKTybQhCsO&amp;eid=375603261%2C466465925&amp;u_h=844&amp;u_w=390&amp;u_ah=844&amp;u_aw=390&amp;u_cd=30&amp;u_his=16&amp;u_tz=540&amp;u_java=false&amp;u_nplug=0&amp;u_nmime=0&amp;sendb=1&amp;ig=1&amp;frm=0&amp;url=http%3A%2F%2Fwww.thehandsome.com%2Fko%2Fc%2Fbr31%2Fbr31&amp;ref=http%3A%2F%2Fwww.thehandsome.com%2Fko%2Fc%2Fbr35%2Fbr35&amp;tiba=%EB%8D%94%ED%95%9C%EC%84%AC%EB%8B%B7%EC%BB%B4&amp;hn=www.googleadservices.com&amp;rfmt=3&amp;fmt=4"></script>
<script
	src="https://cdn.megadata.co.kr/js/socialLink/social_sns_config_min.js"
	type="text/javascript" defer="" async=""></script>
<link rel="stylesheet" type="text/css"
	href="//code.jquery.com/ui/1.12.1/themes/smoothness/jquery-ui.css" />
<link rel="stylesheet" type="text/css"
	href="//static.groobee.io/dist/g2/css/grb-recommend-list_v2.css" />
<link rel="stylesheet" type="text/css"
	href="//static.groobee.io/dist/g2/css/custom-swiper.css" />
</head>
<body class="back vsc-initialized">
	<script th:inline="javascript">
				    /*<![CDATA[*/
				 
				    	//화폐로 변환 기능    	
						function comma(x) {
						    return '₩'+x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
						}
						//컬러칩 클릭시 상품 색상 변경 기능
						function pcchg(e) {
							var id = $(e).attr('id');
							var img = $(e).attr('value');
							var name = $(e).attr('name');
							$('#' + id +' #'+id).attr('src', img);
							$('#' + id).parent().attr('value', id);
							$('button#' + id).removeClass("on");
							$(e).addClass("on");
							$(e).parent().parent().parent().siblings('.categoryImgBox').attr('value', name);
						}
						var price = $('#strPrice').text();
						price = price.substr(1);
						price = price.replace(',', '');
						price = parseInt(price);
						
						//숫자 화폐 단위로 변환 
						function comma(x) {
							return '₩'
									+ x.toString().replace(
											/\B(?=(\d{3})+(?!\d))/g, ",");
						}
						//상품 상세 페이지로 이동 
						function load(t){
							var str = './productDetail';
							str += '?pid=';
							str += $(t).attr('id');
							str += '&pcid=';
							str += $(t).attr('value');
							
							location.href = str;
						};
						//상위 카테고리로 이동 
						function loadListMain(){
							var str = '/product/productList';

									str += '?brand=';
									str += brand;
									str += '&depth1=';
									str += depth1;
									str += '&depth2=';
									str += depth2;
									str += '&depth3=';


							location.href = str;
						};
						//하위 카테고리로 이동 
						function loadList(e){
							if(depth1 == ""){
								depth1 = $(e).text();
							}
							else if(depth2 == ""){
								depth2 = $(e).text();
							}
							else {
								depth3 = $(e).text();
							}
							alert(depth1 + ' ||| '+ depth2 +' ||| ' + depth3)
							var str = '/product/productList';
							str += '?brand=';
							str += brand;
							str += '&depth1=';
							str += depth1;
							str += '&depth2=';
							str += depth2;
							str += '&depth3=';
							str += depth3;
							alert(str);
							location.href = str;
						};
						
						
						var brand = "[(${brand})]";
						var depth1 = "[(${depth1})]";
						var depth2 = "[(${depth2})]";
						var depth3 = "[(${depth3})]";
						var orderBy = /*[[${orderBy}]]*/;
						var Piter = /*[[${Piter}]]*/;
						var productNum = /*[[${productNum}]]*/;

						
						  /*]]>*/
					</script>
	<script>
					var productEnd = false;
					$(window).on("scroll",function(){
					    //위로 스크롤된 길이
					    let scrollTop=$(window).scrollTop();
					    //웹브라우저의 창의 높이
					    let windowHeight=$(window).height();
					    //문서 전체의 높이
					    let documentHeight=$(document).height();
					    //바닥까지 스크롤 되었는 지 여부를 알아낸다.
					    let isBottom=scrollTop+windowHeight + 10 >= documentHeight;

					    if(isBottom && productEnd === false){
									Piter = Piter + productNum;
									if(productEnd == false){
									$.ajax({
										 url : "/product/productListMore", 
										 type : "GET", 
										 data : {
										 brand : brand,
										 depth1 : depth1,
										 depth2 : depth2,
										 depth3 : depth3,
										 Piter : Piter,
										 orderBy : orderBy
										 },
										 success : function(data) { 
											var html ='';
											for(var i = 0; i < data.length; i++){
												html += ' <li class="float active" id="listBody1_li0">';
												html += '<a href="" id="'+data[i].pid+'" class="categoryImgBox" value="'+data[i].pcVO[0].pcid+'">';
												html += '<div class="img">';
												html += '<img src="'+data[i].pcVO[0].pcimg1+'" class="respon_image lazy"';
												html += ' style="display: block" id="'+data[i].pid+'" /> <input '
												html += ' type="hidden" id="'+data[i].pid+'"';
												html += ' value="" />';
												html += '<input type="hidden" id="newImage1_0"  value="" />';
												html += '</div>';
												html += ' </a>';
												html += ' <div class="info_cont">';
												html += '    <div class="color_chip">';
												html += '        <a href="javascript:noLink();" ">';
												html += '<button class="chip on" value="'+data[i].pcVO[0].pcimg1+'"';
												html += 'id="'+data[i].pid+'" onclick="pcchg(this)"';
												html += 'style="'+'background: '+ data[i].pcVO[0].pccolorcode+ ';"';
												html += '></button>';
												for(var j = 1; j < data[i].pcVO.length; j++){
													html += '        <a href="javascript:noLink();" ">';
													html += '<button class="chip" value="'+data[i].pcVO[j].pcimg1+'" name="'+data[i].pcVO[j].pcid+'"';
													html += ' id="'+data[i].pid+'" onclick="pcchg(this)"';
													html += ' style="'+'background: '+ data[i].pcVO[j].pccolorcode+ '";';
													html += '></button>';
												}
													html += '</a>';
													html += '</div>';
													html += '<p class="brand"> '+data[i].bname+'</p>';
													html += '<p class="name"> '+data[i].pname+'</p>';
													html += '<p class="price" id="listPrice'+i+'">';
												html += '<span id="price_IL2D1ACK414W_LE">'+comma(data[i].pcVO[0].pcprice)+'</span>';
												html += '</p></div></li>';
												html += '';
											}
											if(data.length < 8){
												productEnd = true;
											}
											$('#listBody').append(html);
										 },
									 	error : function(request,error) {
											 alert("에러: 잠시후 다시 시도해주세요");
											 alert("code:"+request.status+"\n"+"message:"+request.responseText+"\n"+"error:"+error);
										 }
									 });
									};
								}
							});
					</script>
	<div id="loadingBarDiv" style="display: none"></div>
	<!-- //Loading -->

	<form id="CSRFForm" action="https://www.thehandsome.com/ko/c/br31/br31"
		method="post">
		<div>
			<input type="hidden" name="CSRFToken"
				value="4b2aa8a4-9e8a-4a92-87c4-3bbbaad7fbe7" />
		</div>
	</form>
	<div id="mapleMainPopwrap"
		style="position: fixed; top: 50%; left: 50%; width: 81.333333%; z-index: 805; transform: translate(-50%, -50%); display: none;"></div>

	<div class="layerArea" id="mapleLayer" style="display: none">
		<div class="layerBg"></div>
	</div>

	<!-- ################## hsome_allContents_wrapper | ë³¸ë¬¸ ì»¨íì¸  ìì­ ################## -->
	<div class="hsome_allContents_wrapper">
		<div class="hsome_allContents">
			<!-- ################## header ################## -->
			<header class="hsome_header">
				<h1 class="h_ttl ellipsis" id="headerTitle">
					<a href="javascript:noLink();" onclick="layerUp();" class="select_"
						th:text="${depth}"></a>
				</h1>

				<a href="javascript:noLink();"
					onclick="window.history.back() " class="h_prev">이전
					페이지로 가기</a>
				<ul class="h_gnbMenu">
					<li class="cart"><a
						href="/cart/list"
						><span>cart</span></a>
					</li>
				</ul>
			</header>
			<!-- //################## header ################## -->
			<!-- ################## contents ################## -->
			<div class="hs_product_list_wrap">
				<div class="brand_cont" style="margin: 10px 0 0;">
					<!-- flag_wrap -->
					<div class="cate_wrap191028">
						<!--//previous_category191028 -->

						<!-- flag_wrap -->
						<div
							class="flag_wrap case swiper-container swiper-container-horizontal swiper-container-free-mode swiper-container-ios swiper-container-wp8-horizontal"
							style="height: 44px">
							<ul class="swiper-wrapper"
								style="transform: translate3d(0px, 0px, 0px)">
								<li class="swiper-slide flag on swiper-slide-active"
									th:if="${depth3 == null}" id="categoryNav01"
									style="margin-right: 6px"><a class="name"
									onclick="loadListMain(this)" th:text="${depth0} +' 전체'"></a></li>
								<li class="swiper-slide flag swiper-slide"
									th:if="${depth3 != null}" style="margin-right: 6px"><a
									class="name" onclick="loadListMain(this)"
									th:text="${depth0} +' 전체'"></a></li>
								<li class="swiper-slide flag on swiper-slide"
									style="margin-right: 6px" th:each="list : ${ctgrList}"
									th:if="${list == depth3}"><a class="name"
									onclick="loadList(this)" th:text="${list}"></a></li>
								<li class="swiper-slide flag swiper-slide"
									style="margin-right: 6px" th:each="list : ${ctgrList}"
									th:if="${list != depth3}"><a class="name"
									onclick="loadList(this)" th:text="${list}"></a></li>
							</ul>
						</div>
						<!--// flag_wrap -->
					</div>



				</div>
				<!-- sort_tit -->
				<div class="sort_tit">
					<p class="num_txt" id="totalSpan" th:text="${count} + ' 개'">70
						개</p>
					<div class="hs_tit_select">
						<select id="st2" title="신상품">
							<option value="NEW">신상품</option>
							<option value="HIGH">고가순</option>
							<option value="LOW">저가순</option>
						</select>
					</div>
				</div>
				<!--// sort_tit -->

				<!-- product_list -->
				<div class="hs_product_list" id="hsProductList">
					<ul id="listBody">
						<li class="float active" 
							th:each="list : ${productVO}"><a
							class="categoryImgBox"
							th:value="${list.pcVO[0].pcid}"
							th:id="${list.pid}">
								<div class="img">
									<img th:src="${list.pcVO[0].pcimg1}" class="respon_image lazy"
										style="display: block" th:id="${list.pid}" />
								</div>
						</a>
							<div class="info_cont">
								<div class="color_chip">
									<a href="javascript:noLink();" th:each="list2 : ${list.pcVO}">
										<button class="chip on" th:value="${list2.pcimg1}"
											th:id="${list.pid}" onclick="pcchg(this)"
											th:name="${list2.pcid}"
											th:style="'background: '+ ${list2.pccolorcode}+ '; 				
									'"
											th:if="${list2Stat.first}"></button>
										<button class="chip" th:value="${list2.pcimg1}"
											th:id="${list.pid}" onclick="pcchg(this)"
											th:name="${list2.pcid}"
											th:style="'background: '+ ${list2.pccolorcode}+ '; 
									'"
											th:if="${list2Stat.first != true}"></button>
									</a>
								</div>
								<p class="brand" th:text="${list.bname}"></p>
								<p class="name" th:text="${list.pname}"></p>
								<p class="price" id="listPrice0">
									<span id="price_IL2D1ACK414W_LE"
										th:text="'₩'+${#numbers.formatInteger(list.pcVO[0].pcprice, 0, 'COMMA')}">￦19,000</span>
								</p>
							</div></li>

					</ul>
				</div>
				<!--// product_list -->
			</div>
			<!-- //################## contents ################## -->

			<!-- ################## footer ################## -->

		</div>

	</div>
	<!-- ################## //hsome_allContents_wrapper | ë³¸ë¬¸ ì»¨íì¸  ìì­ ################## -->
	<!-- ################## hsome_quickMenu | 퀵메뉴 ################## -->
	<aside class="hsome_quickMenu hsome_quickMenu1909 active">
		<ul>
			<li class="shop active" style="width: 33.3%;"><a
				onclick="layerUp()"><i>메뉴</i></a></li>
			<li class="home" style="width: 33.3%;"><a
				href="/"
				onclick="goMainpage();GA_Event('공통', '네비게이션_바', '홈');"><i>홈</i></a>
			</li>
			<li class="mypage" id="gnbMyPageBtn" style="width: 33.3%;"><a
				href="/myPage/myPage"
				onclick="goMypage();GA_Event('공통', '네비게이션_바', '마이페이지');"><i>마이페이지</i></a>
			</li>
			<li class="mypage pageMove" style="display: none"><a href=""
				id="gnbMypageBtn"></a></li>
			<li class="mypage" style="display: none"><a
				href="https://www.thehandsome.com/ko/mobilecommon/myPagePopup"
				id="gnbMypagePopupBtn"></a></li>
		</ul>
	</aside>
	<!-- ################## //hsome_quickMenu | 퀵메뉴 ################## -->

	<!-- ################## hsome_quickMenu_contents | 퀵메뉴 컨텐츠 영역 ################## -->
	<th:block th:replace="fragments/footer :: footerFragment"></th:block>
	<!--// ################## hsome_quickMenu_contents | 퀵메뉴 컨텐츠 영역 ################## -->

	<!-- 댓글// -->
	<div class="hsome_layer_popup hs_img_upload_pop">
		<div class="pop-comm-cnts">
			<div class="swiper-container">
				<div class="swiper-wrapper">
					<div class="swiper-slide">
						<img id="reply_view_img1"
							src="https://www.thehandsome.com/_ui/handsomemobile/images/common/no_img.jpg"
							alt="" />
					</div>
					<div class="swiper-slide">
						<img id="reply_view_img2"
							src="https://www.thehandsome.com/_ui/handsomemobile/images/common/no_img.jpg"
							alt="" />
					</div>
				</div>
				<div class="swiper-pagination"></div>
			</div>
		</div>
		<a href="javascript:void(0);" class="pop-comm-cls"
			onclick="closUploadPop()">닫기</a>
	</div>


	<!-- layerpop_wrap -->
	<div class="layerpop_wrap loading_layer_wrap">
		<!-- layerpop_middle s -->
		<div class="lyrpp_mid">
			<div class="loading_box"></div>
		</div>
		<!-- layerpop_middle -->
	</div>
	<!-- layerpop_wrap -->
	<script>
	$(document).on('click','.categoryImgBox',function(e){
		e.preventDefault();
		load(this,"");
	})
	//스와이퍼 시작 
var flagWrapSwiper = new Swiper(
		".flag_wrap.case.swiper-container", {
			slidesPerView : "auto",
			freeMode : true,
			spaceBetween : 6,
			freeModeMomentumBounce : false,
		});
	// 상품 리스트 조건별로 변경 
	$('#st2').change(function() {
	    var order = $(this).val();
	    if (order == "NEW"){
	    	orderBy = 3;
	    }else if (order == "HIGH"){
	    	orderBy = 2;
	    }else{
	    	orderBy = 1;
	    }
	    Piter = 1;
	    $.ajax({
			 url : "./productListMore", 
			 type : "GET", 
			 data : {
			 brand : brand,
			 depth1 : depth1,
			 depth2 : depth2,
			 depth3 : depth3,
			 Piter : 1,
			 orderBy : orderBy
			 },
			 success : function(data) { 
				var html ='';
				for(var i = 0; i < data.length; i++){
					html += ' <li class="float active" id="listBody1_li0">'
					html += '<a href="" id="'+data[i].pid+'" class="categoryImgBox" value="'+data[i].pcVO[0].pcid+'">';
					html += '<div class="img">';
					html += '<img src="'+data[i].pcVO[0].pcimg1+'" class="respon_image lazy"';
					html += 'style="display: block" id="'+data[i].pid+'" />';
					html += '</div>';
					html += ' </a>';
					html += ' <div class="info_cont">';
					html += '    <div class="color_chip">';
					html += '        <a href="javascript:noLink();" ">';
					html += '<button class="chip on" value="'+data[i].pcVO[0].pcimg1+'"';
					html += 'id="'+data[i].pid+'" onclick="pcchg(this)"';
					html += 'style="'+'background: '+ data[i].pcVO[0].pccolorcode+ '";';
					html += '></button>';
					for(var j = 1; j < data[i].pcVO.length; j++){
						html += '        <a href="javascript:noLink();" ">';
						html += '<button class="chip" value="'+data[i].pcVO[j].pcimg1+'"';
						html += ' id="'+data[i].pid+'" onclick="pcchg(this)" name="'+data[i].pcVO[j].pcid+'"';
						html += ' style="'+'background: '+ data[i].pcVO[j].pccolorcode+ '";';
						html += '></button>';
					}
						html += '</a>';
						html += '</div>';
						html += '<p class="brand"> '+data[i].bname+'</p>';
						html += '<p class="name"> '+data[i].pname+'</p>';
						html += '<p class="price" id="listPrice'+i+'">';
					html += '<span id="price_IL2D1ACK414W_LE">'+comma(data[i].pcVO[0].pcprice)+'</span>';
					html += '</p></div></li>';
					html += '';
				}
				$('#listBody').html(html);
			 },
		 	error : function(request,error) {
				 alert("에러: 잠시후 다시 시도해주세요");
				 alert("code:"+request.status+"\n"+"message:"+request.responseText+"\n"+"error:"+error);
			 }
		 });
	});
	
	function goBack(){
	      window.history.back();
	}
</script>

</body>
<!-- This script is for AceCounter START -->
</html>
